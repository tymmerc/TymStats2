<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Spotify Stats</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Spotify Statistics</h1>
    <canvas id="spotifyChart" width="400" height="200"></canvas>

    <table id="songsTable" border="1">
        <thead>
            <tr>
                <th>Titre</th>
                <th>Nombre d'écoutes</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <script>
        // Vérifier si l'utilisateur a un access token
    const token = localStorage.getItem('spotifyAccessToken');

if (token) {
    // Appeler l'API Spotify pour récupérer les morceaux
    fetchSpotifyData(token);
} else {
    console.log("Aucun token trouvé. Veuillez vous connecter à Spotify.");
}

/**
 * Fonction pour appeler l'API Spotify et récupérer les morceaux.
 * @param {string} token - Le jeton d'accès Spotify.
 */
function fetchSpotifyData(token) {
    fetch('https://api.spotify.com/v1/me/top/tracks?limit=10', {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    })
        .then(response => response.json()) // Convertir la réponse en JSON
        .then(data => {
            console.log("Données Spotify reçues :", data);

            if (data.items) {
                // Créer un graphique avec les morceaux récupérés
                createChart(data.items);
            } else {
                console.log("Erreur : Impossible de récupérer les morceaux.");
            }
        })
        .catch(error => console.log("Erreur lors de la récupération des données Spotify :", error));
}

const labels = ["Chanson 1", "Chanson 2", "Chanson 3"];
const values = [50, 75, 100];

const ctx = document.getElementById('spotifyChart').getContext('2d');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Popularité des morceaux',
            data: values,
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});


        
    </script>
</body>
</html>
